{"ast":null,"code":"/*eslint-disable*/import React,{useState,useMemo,useEffect}from'react';import axios from'axios';import{useCRUD,useBoolean,useFetch}from'hooks';import Card from'components/Card/Card';import CardBody from'components/Card/CardBody';import CardHeader from'components/Card/CardHeader';import CardText from'components/Card/CardText';import globalStyles from'assets/jss/material-dashboard-pro-react/views/common';import{Filter,Details,Table,DetailsClient,TableWithoutClient}from'./components';const portfolioPerAge=[18305000,24305000,54305000,14305000];const ConsultationPortfolio=()=>{const globalClasses=globalStyles();const{data,loading}=useFetch('/api/creditos');const{fields,remove,append,update,replace}=useCRUD([]);const[selectedClient,setSelectedClient]=useState('all');const[selectedShowClient,setSelectedShowClient]=useState();const[fieldsCreditClient,setFieldsCreditClient]=useState();const[dataOnlyClient,setDataOnlyClient]=useState();const[subLoading,setSubLoading]=useState(false);const[open,setOpen]=useBoolean(false);const handleSelected=_ref=>{let{target}=_ref;console.log(target.value);setSelectedClient(target.value);};useEffect(()=>{if(data)replace(data.clientes);},[data]);useEffect(()=>{if(selectedClient!=='all'){credits_client();}},[selectedClient]);const client=useMemo(()=>selectedClient!=='all'?fields.find(_ref2=>{let{id_clientes}=_ref2;return id_clientes===selectedClient;}):{id_clientes:'0',nombres:'TODOS',apellidos:''},[selectedClient,fields]);const showClient=useMemo(()=>fields.find(_ref3=>{let{id_clientes}=_ref3;return id_clientes===selectedShowClient;}),[selectedShowClient,fields]);const credits_client=()=>{setSubLoading(true);axios.get(`api/creditos_cliente/${selectedClient}`).then(res=>{setFieldsCreditClient(res.data);setDataOnlyClient(res.data);setSubLoading(false);}).catch(err=>{console.log(err);});};const onOpen=id=>{setSelectedShowClient(id);setOpen(true);};const onClose=()=>{setSelectedShowClient(before=>before===undefined?null:undefined);setOpen(false);};const create=data=>{axios.post('api/clientes',data).then(res=>{//append(res.data)//Preguntar si aqui agrega para que se vea en la tabla\nonClose();}).catch(err=>{console.log(err);});};const edit=(id,data)=>{axios.put(`api/clientes/${id}`,data).then(res=>{update(id,res.data);onClose();}).catch(err=>{console.log(err);});};const _delete=id=>{axios.delete(`api/clientes/${id}`).then(()=>{remove(id);onClose();}).catch(err=>{console.log(err);});};const onSave=(data,id)=>{if(id)edit(id,data);else create(data);};return/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,{color:\"primary\",text:true},/*#__PURE__*/React.createElement(CardText,{className:globalClasses.cardText,color:\"primary\"},/*#__PURE__*/React.createElement(\"h4\",{className:globalClasses.colorWhite},\"Consultas a cartera\"))),/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(Filter,{clients:fields,loading:loading,selected:selectedClient,handleSelected:handleSelected}),!loading&&!subLoading&&/*#__PURE__*/React.createElement(Details,{client:client,data:data,selected:selectedClient,dataOnlyClient:dataOnlyClient,loading:selectedClient!=='all'?subLoading:loading,portfolioPerAge:portfolioPerAge}),selectedClient==='all'?/*#__PURE__*/React.createElement(TableWithoutClient,{clients:fields,loading:loading,onDelete:_delete,onOpen:onOpen}):/*#__PURE__*/React.createElement(Table,{client:fieldsCreditClient,loading:subLoading}),/*#__PURE__*/React.createElement(DetailsClient,{open:open,onClose:onClose,onSubmit:onSave,client:showClient})));};export default ConsultationPortfolio;","map":{"version":3,"names":["React","useState","useMemo","useEffect","axios","useCRUD","useBoolean","useFetch","Card","CardBody","CardHeader","CardText","globalStyles","Filter","Details","Table","DetailsClient","TableWithoutClient","portfolioPerAge","ConsultationPortfolio","globalClasses","data","loading","fields","remove","append","update","replace","selectedClient","setSelectedClient","selectedShowClient","setSelectedShowClient","fieldsCreditClient","setFieldsCreditClient","dataOnlyClient","setDataOnlyClient","subLoading","setSubLoading","open","setOpen","handleSelected","_ref","target","console","log","value","clientes","credits_client","client","find","_ref2","id_clientes","nombres","apellidos","showClient","_ref3","get","then","res","catch","err","onOpen","id","onClose","before","undefined","create","post","edit","put","_delete","delete","onSave","createElement","color","text","className","cardText","colorWhite","clients","selected","onDelete","onSubmit"],"sources":["C:/Users/HUAWEI/Documents/GitHub/SinfonyPlataforma/src/views/Portfolio/Consultation/Consultation.jsx"],"sourcesContent":["/*eslint-disable*/\r\nimport React, { useState, useMemo, useEffect } from 'react'\r\n\r\nimport axios from 'axios'\r\n\r\nimport { useCRUD, useBoolean, useFetch } from 'hooks'\r\nimport Card from 'components/Card/Card'\r\nimport CardBody from 'components/Card/CardBody'\r\nimport CardHeader from 'components/Card/CardHeader'\r\nimport CardText from 'components/Card/CardText'\r\nimport globalStyles from 'assets/jss/material-dashboard-pro-react/views/common'\r\n\r\nimport { Filter, Details, Table, DetailsClient, TableWithoutClient } from './components'\r\n\r\nconst portfolioPerAge = [18305000, 24305000, 54305000, 14305000]\r\n\r\nconst ConsultationPortfolio = () => {\r\n  const globalClasses = globalStyles()\r\n  const { data, loading } = useFetch('/api/creditos')\r\n\r\n  const { fields, remove, append, update, replace } = useCRUD([])\r\n  const [selectedClient, setSelectedClient] = useState('all')\r\n  const [selectedShowClient, setSelectedShowClient] = useState()\r\n  const [fieldsCreditClient, setFieldsCreditClient] = useState()\r\n  const [dataOnlyClient, setDataOnlyClient] = useState()\r\n  const [subLoading, setSubLoading] = useState(false)\r\n  const [open, setOpen] = useBoolean(false)\r\n\r\n  const handleSelected = ({ target }) => {\r\n    console.log(target.value)\r\n    setSelectedClient(target.value)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (data) replace(data.clientes)\r\n  }, [data])\r\n\r\n  useEffect(() => {\r\n    if (selectedClient !== 'all') {\r\n      credits_client()\r\n    }\r\n  }, [selectedClient])\r\n\r\n  const client = useMemo(\r\n    () =>\r\n      selectedClient !== 'all'\r\n        ? fields.find(({ id_clientes }) => id_clientes === selectedClient)\r\n        : {\r\n          id_clientes: '0',\r\n          nombres: 'TODOS',\r\n          apellidos: '',\r\n        },\r\n    [selectedClient, fields]\r\n  )\r\n\r\n  const showClient = useMemo(() => fields.find(({ id_clientes }) => id_clientes === selectedShowClient), [\r\n    selectedShowClient,\r\n    fields,\r\n  ])\r\n\r\n  const credits_client = () => {\r\n    setSubLoading(true)\r\n    axios.get(`api/creditos_cliente/${selectedClient}`)\r\n      .then(res => {\r\n        setFieldsCreditClient(res.data)\r\n        setDataOnlyClient(res.data)\r\n        setSubLoading(false);\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  const onOpen = id => {\r\n    setSelectedShowClient(id)\r\n    setOpen(true)\r\n  }\r\n\r\n  const onClose = () => {\r\n    setSelectedShowClient(before => (before === undefined ? null : undefined))\r\n    setOpen(false)\r\n  }\r\n\r\n  const create = data => {\r\n    axios\r\n      .post('api/clientes', data)\r\n      .then(res => {\r\n        //append(res.data)//Preguntar si aqui agrega para que se vea en la tabla\r\n        onClose()\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  const edit = (id, data) => {\r\n    axios\r\n      .put(`api/clientes/${id}`, data)\r\n      .then(res => {\r\n        update(id, res.data)\r\n        onClose()\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  const _delete = id => {\r\n    axios\r\n      .delete(`api/clientes/${id}`)\r\n      .then(() => {\r\n        remove(id)\r\n        onClose()\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  const onSave = (data, id) => {\r\n    if (id) edit(id, data)\r\n    else create(data)\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader color=\"primary\" text>\r\n        <CardText className={globalClasses.cardText} color=\"primary\">\r\n          <h4 className={globalClasses.colorWhite}>Consultas a cartera</h4>\r\n        </CardText>\r\n      </CardHeader>\r\n      <CardBody>\r\n        <Filter clients={fields} loading={loading} selected={selectedClient} handleSelected={handleSelected} />\r\n        {!loading && !subLoading && <Details client={client} data={data} selected={selectedClient} dataOnlyClient={dataOnlyClient} loading={selectedClient !== 'all' ? subLoading : loading} portfolioPerAge={portfolioPerAge} />}\r\n        {selectedClient === 'all' ? (\r\n          <TableWithoutClient clients={fields} loading={loading} onDelete={_delete} onOpen={onOpen} />\r\n        ) : (\r\n          <Table client={fieldsCreditClient} loading={subLoading}/>\r\n        )}\r\n        <DetailsClient open={open} onClose={onClose} onSubmit={onSave} client={showClient} />\r\n      </CardBody>\r\n    </Card>\r\n  )\r\n}\r\n\r\nexport default ConsultationPortfolio\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}